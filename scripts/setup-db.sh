#!/bin/sh

echo "🔄 إعداد قاعدة البيانات..."

# انتظار حتى تصبح قاعدة البيانات جاهزة
until npx prisma db push --accept-data-loss; do
  echo "⏳ انتظار قاعدة البيانات..."
  sleep 2
done

echo "✅ تم إعداد قاعدة البيانات بنجاح"

# تشغيل البذور إذا لم تكن موجودة
echo "🌱 إضافة البيانات التجريبية..."
npx prisma db seed || echo "⚠️ البيانات التجريبية موجودة بالفعل"

echo "🚀 بدء التطبيق..."
exec "$@"
